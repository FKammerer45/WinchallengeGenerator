{% extends "base.html" %}
{% block title %}Games Configuration{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>Games Configuration</h2>

  <!-- Pass login status to JavaScript -->
  <script>
    const isLoggedIn = {{ current_user.is_authenticated| tojson }};
  </script>
  <!-- Confirm Load Default Entries Modal -->
  <div class="modal fade" id="confirmLoadDefaultModal" tabindex="-1" role="dialog"
    aria-labelledby="confirmLoadDefaultModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmLoadDefaultModalLabel">Load Default Entries</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          Are you sure you want to load the default entries? This will override your current default tab.
        </div>
        <div class="modal-footer">
          <button type="button" id="cancelLoadDefaultBtn" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <button type="button" id="confirmLoadDefaultBtn" class="btn btn-primary">Yes, Load</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabs Navigation -->
  <ul class="nav nav-tabs" id="gamesTab" role="tablist">
    <!-- Default (read-only) tab -->
    <li class="nav-item" ondblclick="alert('The Default tab cannot be renamed.')" style="cursor: not-allowed;">
      <a class="nav-link active" id="default-tab" data-toggle="tab" href="#default" role="tab" aria-controls="default"
        aria-selected="true">
        Default
      </a>
    </li>
    <!-- Plus-Button for new editable tab -->
    <li class="nav-item">
      <a class="nav-link" href="#" id="addTabBtn" role="tab">+</a>
    </li>
  </ul>

  <!-- Tab Contents -->
  <div class="tab-content mt-3" id="gamesTabContent">
    <!-- Default Tab Pane (read-only, no editing buttons) -->
    <div class="tab-pane fade show active" id="default" role="tabpanel" aria-labelledby="default-tab">
      <!-- Insert button added to the default tab -->
      <!-- New button to load default entries -->
      <button id="loadDefaultEntriesBtn" class="btn btn-warning mb-3">
        Load Default Entries
      </button>
      <div class="my-3">
        <button class="btn btn-primary insertGameBtn" data-tab="default">Insert</button>
      </div>
      {% include "games/games_table.html" %}
    </div>
    <!-- New tabs will be dynamically created here (editable) -->
  </div>

  <!-- Include modals markup so the newGameModal exists in the DOM -->
  {% include "games/games_modals.html" %}
</div>
{% endblock %}

{% block scripts %}
<script type="module" src="{{ url_for('static', filename='js/games/main.js') }}"></script>
<script>
  // Optional: Prevent renaming of the default tab on double-click.
  document.getElementById("default-tab").addEventListener("dblclick", (e) => {
    alert("The Default tab cannot be renamed.");
  });
</script>
{% endblock %}