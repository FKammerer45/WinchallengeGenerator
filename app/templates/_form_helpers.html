{# app/templates/_form_helpers.html #}
{# Macro to render a WTForms field with Bootstrap styling and errors #}
{% macro render_field(field, label_visible=true) %}
  <div class="form-group mb-3">
    {% if label_visible and field.label %}
      {{ field.label(class="form-label") }}
    {% endif %}
    
    {# Add is-invalid class to field if errors exist #}
    {% set field_class = kwargs.pop('class', '') + (' is-invalid' if field.errors else '') %}
    {{ field(class=field_class, **kwargs) }}
    
    {% if field.errors %}
      <div class="invalid-feedback">
        {% for error in field.errors %}
          <span>{{ error }}</span><br>
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% endmacro %}
{% macro rename_tab_modal(context) -%}
  {%- set cap = context|capitalize -%}
  <div class="modal fade" id="rename{{ cap }}TabModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <form id="rename{{ cap }}TabForm" class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Rename {{ cap }} Tab</h5>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          <input
            type="text"
            id="rename{{ cap }}TabInput"
            class="form-control"
            placeholder="New {{ context }} tab name"
          />
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            Cancel
          </button>
          <button type="submit" class="btn btn-primary">
            Save
          </button>
        </div>
      </form>
    </div>
  </div>
{%- endmacro %}
{% macro confirm_action_modal(modal_id='actionConfirmModal', title_id='actionConfirmTitle', body_id='actionConfirmBody', ok_id='actionConfirmOk', title='Please confirm', ok_text='OK', cancel_text='Cancel') %}
<div class="modal fade" id="{{ modal_id }}" tabindex="-1" role="dialog" aria-labelledby="{{ title_id }}" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content shadow"> {# Style handled by style.css #}
      <div class="modal-header py-2"> {# Reduced padding #}
        <h5 class="modal-title" id="{{ title_id }}">{{ title }}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="{{ body_id }}">
        {# Content set dynamically by JS #}
        Are you sure you want to proceed?
      </div>
      <div class="modal-footer py-2"> {# Reduced padding #}
        <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">{{ cancel_text }}</button>
        <button type="button" class="btn btn-primary btn-sm" id="{{ ok_id }}">{{ ok_text }}</button> {# Use primary color for OK #}
      </div>
    </div>
  </div>
</div>
{% endmacro %}