<!-- THIS IS custom_base.html - IF YOU SEE THIS, THE TEMPLATE IS BEING USED -->
{% extends 'admin/base.html' %}

{% block brand %}
    {{ super() }}
    <span class="badge badge-info ml-2">CustomBase</span> {# Visible marker #}
{% endblock %}

{# Attempt to place logout form in the 'tail' block #}
{% block tail %}
  <div style="position: fixed; bottom: 10px; right: 10px; z-index: 9999; background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 10px; border-radius: 5px;">
    {% if session.get('admin_logged_in') %}
        <form id="adminLogoutFormTail" method="POST" action="{{ url_for('admin_auth.logout') }}" style="margin: 0; padding: 0;">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="btn btn-danger">Logout Admin (from Tail)</button>
        </form>
    {% else %}
        <p style="color: red; margin: 0;">Admin not logged in (according to session in tail block)</p>
    {% endif %}
  </div>
  {{ super() }} {# This will include the original tail block content, including tail_js #}
{% endblock %}


{# Ensure window.csrfToken is available for other JS if needed #}
{% block tail_js %}
    {{ super() }}
    <script>
        if (typeof window.csrfToken === 'undefined') {
            window.csrfToken = "{{ csrf_token() }}";
        }
    </script>
    {# Explicitly include admin_logout.js here #}
    <script src="{{ url_for('static', filename='js/admin_logout.js') }}"></script>
{% endblock %}
