{# templates/challenge/_group_card_content.html #}
{# Renders the content for a single group card #}
{# Expects context variables: group, challenge, is_member, is_multigroup, num_players_per_group #}

{# Determine wrapper classes based on whether this is the joined group #}
{% set wrapper_classes = 'col-lg-4 col-md-6 mb-4 group-card-wrapper' %}
{% if is_member %}
  {% set wrapper_classes = 'col-md-8 col-lg-6 mx-auto mb-4 group-card-wrapper joined-group-layout' %}
{% endif %}

<div class="{{ wrapper_classes }}" data-group-id="{{ group.id }}">
  {# *** ADDED glass-effect class *** #}
  <div class="card group-card h-100 shadow-sm glass-effect">
    <div class="card-body">
      <h5 class="card-title">{{ group.name | escape }}</h5>

      {# Placeholder div for the group-specific progress bar #}
      <div id="progressBarContainer-{{ group.id }}" class="group-progress-bar-container mb-3">
          {# JS will render the progress bar here via updateUIAfterMembershipChange #}
      </div>

      {# Include progress checkboxes - passes the group dict and challenge object #}
      {% include 'challenge/_challenge_group_progress.html' ignore missing %}

      {# Placeholder for Player Name inputs (JS will render/show if needed) #}
      <div class="player-names-section mt-3 border-top pt-3" style="display: none;">
         <h6 class="small mb-2">Group Players (Max {{ num_players_per_group }}):</h6>
         <div class="player-name-inputs"></div> {# JS fills this #}
         <div class="player-name-error text-danger small mt-1"></div> {# JS shows errors here #}
         {# JS adds save button here #}
      </div>

    </div> {# End card-body #}

     {# Active Penalty Display (JS updates content and visibility) #}
    <div class="active-penalty-display mt-2 border-top pt-2 mx-3 mb-2" data-group-id="{{ group.id }}" style="{{ 'display: none;' if not group.active_penalty_text }}">
         <h6 class="small mb-1">Active Penalty:</h6>
         <p class="mb-0 small penalty-text-content">{{ group.active_penalty_text | escape if group.active_penalty_text else '' }}</p>
         {# Clear button added by JS if user is member #}
    </div>

    {# Footer for Join/Leave buttons (JS manages the button content/state) #}
    {% if is_multigroup %}
    <div class="card-footer text-center join-leave-footer">
       {# Button content/state set dynamically by challenge_ui.js #}
    </div>
    {% endif %}
  </div> {# End card #}
</div> {# End wrapper #}
